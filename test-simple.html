<!DOCTYPE html>
<html>
<head>
    <title>Simple Gemini Test</title>
</head>
<body>
    <h1>Simple Gemini Test</h1>
    <button onclick="test()">Test "one over two"</button>
    <div id="result"></div>

    <script>
        async function test() {
            const API_KEY = 'AIzaSyAq76x1Ov2p3MOb5um523Iepjo0yOoPUEM';
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing...';

            const prompt = `Evaluate if the student's answer is mathematically correct.

Question: Convert 50% to a fraction in its simplest form.
Correct Answer: 1/2
Student's Answer: one over two

IMPORTANT: "one over two" means the same as "1/2" - it's just written in words!

Respond ONLY with JSON:
{
  "isCorrect": true or false,
  "feedback": "your feedback"
}`;

            try {
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${API_KEY}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }],
                            generationConfig: {
                                temperature: 0.2,
                                maxOutputTokens: 256,
                            }
                        }),
                    }
                );

                const data = await response.json();
                console.log('Full response:', data);
                
                const text = data.candidates[0].content.parts[0].text;
                console.log('Raw text:', text);
                
                const cleanText = text.replace(/```json\n?|\n?```/g, '').trim();
                console.log('Clean text:', cleanText);
                
                const result = JSON.parse(cleanText);
                console.log('Parsed result:', result);

                resultDiv.innerHTML = `
                    <h2>Result: ${result.isCorrect ? '✅ CORRECT' : '❌ INCORRECT'}</h2>
                    <p>${result.feedback}</p>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
